<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0049)https://reasonablypolymorphic.com/book/tapes.html -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
        <title>Tapes :: Reasonably Polymorphic</title>
        <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
        <link href="https://reasonablypolymorphic.com/atom.xml" rel="alternate" title="Reasonably Polymorphic - Atom" type="application/atom+xml">
        <link href="https://reasonablypolymorphic.com/feed.rss" rel="alternate" title="Reasonably Polymorphic - RSS" type="application/rss+xml">

        <link href="./Tapes __ Reasonably Polymorphic_files/css" rel="stylesheet" type="text/css">
        <link href="./Tapes __ Reasonably Polymorphic_files/style.css" type="text/css" rel="stylesheet">
        <link href="./Tapes __ Reasonably Polymorphic_files/syntax.css" type="text/css" rel="stylesheet">

        <script async="" src="./Tapes __ Reasonably Polymorphic_files/analytics.js"></script><script type="text/javascript" src="./Tapes __ Reasonably Polymorphic_files/jquery-2.1.4.min.js"></script>
        <script type="text/javascript" src="./Tapes __ Reasonably Polymorphic_files/baseline.js"></script>
        <script type="text/x-mathjax-config;executed=true">
            MathJax.Hub.Config({
                    "HTML-CSS": {
                        scale: 50
                    },
  TeX: {extensions: [ "AMSmath.js"
                    , "AMSsymbols.js"
                    , "color.js"
                    , "http://sonoisa.github.io/xyjax_ext/xypic.js"
                    ]}
            });
        </script>
        <script src="./Tapes __ Reasonably Polymorphic_files/MathJax.js" id=""></script>
          <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76834556-1', 'auto');
  ga('send', 'pageview');
  </script>

        <style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
        <body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

<div class="column">
    <article>
<header>
    <h1><a href="https://reasonablypolymorphic.com/book/tapes">Tapes</a></h1>
</header>
<p class="meta">
    
    <span class="prev">
        <a href="https://reasonablypolymorphic.com/book/our-first-computer">←</a>
    </span>
    
    
    <span class="next">
        <a href="https://reasonablypolymorphic.com/book/operations">→</a>
    </span>
    
    <time>November 25, 2016</time>
    
        <span class="tags">
        
        </span>
    
</p>
<div class="content">
    <p>In the last chapter, we discussed the <em>P’’</em> computer architecture – a highly simplified computer consisting of two tapes. <em>P’’</em> has a <em>program tape</em>, which contains the current program to run, and it also has a <em>memory tape</em>, where it can store <code>Nat</code>s as a form of “scratch work.”</p>
<p>As a required step towards building a <em>P’’</em> machine, we’ll obviously need to build this tape <strong>data structure</strong>. A <em>data structure</em> is a container for storing information, complete with an interface for interacting with it, and trade-offs for when one <em>data structure</em> should be used in place of another.</p>
<h2 id="tapes">Tapes</h2>
<p>We’ve already seen a <em>data structure</em>, the <code>List a</code>. <code>List a</code> fits our description for what it means to be a <em>data structure</em>: it is a container of elements of type <code>a</code>, and its interface allows us to pull off the front of the list, getting back the element there, and the remainder of the list. We’ll look at trade-offs later when we discuss the Big-O notation, but that won’t be for some time yet.</p>
<p>Before we go ahead and build a tape, we should probably understand what a tape is, and how we’ll want to interact with it. Recall that a tape has a <em>read head</em>, which corresponds to the “active” element on the tape; we’re only ever allowed to look at the <em>read head</em> of the tape. In addition, we have two spools on either side of the read head, which act as a kind of “storage”. As we move the <em>read head</em> left and right, the value at the <em>read head</em> moves to one of the spools, and a new value comes under the <em>read head</em> from the other spool. We also said that tapes are <em>infinitely long</em> in both directions, a fact we’ll need to deal with at some point.</p>
<p>So, conceptually, we can represent a tape as some new type <code>Tape a</code>, consisting of two “spools containing <code>a</code>s”, and a distinguished “read head”, itself of type <code>a</code>. But what should these “spools” be? Well, let’s go back to our use-cases and see what we need from the spools. The spools only ever absorb or provide a new element for the <em>read head</em> – meaning we need to either be able to put an element onto the spool, or take one off. Also, we’d like to get the elements out of the spool in the <em>opposite order</em> that we put them in on. Think about this like a VHS tape – the further back you rewind from a moment, the more you need to fast-forward to get back to where you were.</p>
<p>With all of this in our minds simultaneously, we see that the “spools” we wanted are nothing more than just <code>List a</code>. We can always pull the head off of a <code>List a</code> (provide an <code>a</code> to the <em>read head</em>), or “push” one in (absorbing the <em>read head</em>). Since we can only ever get the first thing in the list, if we add things to the front of the list, we’ll get the desired property that elements come out in the opposite order that they were added. This property is sometimes known as “last in, first out”.</p>
<p>We’re now ready to provide a type definition for tapes:</p>
<pre><code>type Tape a = Tape (List a) a (List a)</code></pre>
<p>A <code>Tape a</code> is nothing more than two <code>List a</code>s representing the spools, and a value of type <code>a</code> sitting in the middle, representing our <em>read head</em>. We’ll provide a few helper functions to deal with a <code>Tape a</code>:</p>
<pre><code>readHead : Tape a -&gt; a
readHead (Tape _ a _) = a</code></pre>
<p><code>readHead : Tape a -&gt; a</code> is nothing but a function that gets the current value “under focus” of the tape – which is to say, the <em>read head</em>. We also need some functions to move the <em>read head</em> left and right:</p>
<pre><code>moveLeft : Tape a -&gt; Tape a
moveLeft (Tape (Cons l ls) a rs) = Tape ls l (Cons a rs)
moveLeft (Tape Nil         a rs) = ???</code></pre>
<p><code>moveLeft : Tape a -&gt; Tape a</code> takes the first thing off the left-most spool, and moves it to the current <em>read head</em>. It pushes the current <em>read head</em> into the right-most spool. But there’s a problem! What happens if our left-most spool is <code>Nil</code> (empty)? Conceptually, our spools are infinitely long, but we don’t have a notion of infinity to work with, unfortunately. The best we can do is to “magically” pull <code>a</code>s out of nowhere, and pretend like they were in the spool to begin with. But which value of type <code>a</code> should we choose?</p>
<p>Because <code>a</code> is polymorphic, there’s no “obvious” answer for which <code>a</code> to use. It’s going to depend on the specific type that fills in the type variable <code>a</code>. For the program tape, we probably want to fill in the rest of the tape with <em>Halt</em> instructions. But for the memory tape, we want to fill it in with <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.269em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.449em, 1000.44em, 2.891em, -1000.04em); top: -2.485em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mn" id="MathJax-Span-3" style="font-family: STIXGeneral-Regular;">0</span></span><span style="display: inline-block; width: 0px; height: 2.498em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.065em; border-left: 0px solid; width: 0px; height: 0.481em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-1">0</script></span>s.</p>
<p>We can capture this “most interesting element” to fill the tapes with via a new <code>class</code> of patterns, just like we had the <code>Kleisli</code> class pattern!</p>
<pre><code>class Point a where
  point : a</code></pre>
<p>This should be read as “<code>Point</code> is a class of patterns, parameterized by some type <code>a</code>. This pattern is in effect whenever we have a value <code>point : a</code>.” You can think of a <code>Point a</code> as being some type <code>a</code> with a “point of interest”. With this <code>point : a</code> machinery in place, let’s revisit <code>moveLeft</code>:</p>
<pre><code>moveLeft : Point a =&gt; Tape a -&gt; Tape a
moveLeft (Tape (Cons l ls) a rs) = Tape ls  l     (Cons a rs)
moveLeft (Tape Nil         a rs) = Tape Nil point (Cons a rs)</code></pre>
<p>Now, if the left-most spool runs out of elements, we can use our witness of a <code>Point a</code> pattern to “pull an <code>a</code> out of nowhere!” Recall that <code>point : a</code> is a value that exists whenever we have a witness of the <code>Point a</code> pattern.</p>
<p>The machine for <code>moveRight</code> is symmetric to the <code>moveLeft</code> example:</p>
<pre><code>moveRight : Point a =&gt; Tape a -&gt; Tape a
moveRight (Tape ls a (Cons r rs)) = Tape (Cons a ls) r     rs
moveRight (Tape ls a Nil)         = Tape (Cons a ls) point Nil</code></pre>
<p>It’s worth thinking about this “pulling <code>a</code>s out of nowhere” trick and why it works. Conceptually our spools have infinite length, but because the universe doesn’t have infinite size, we can’t directly make an equivalent analogue. However, what we can do is make a spool that is “as big as necessary”. Unfortunately, we don’t know how big “necessary” is in advance, so our next best bet is to make a spool that can become larger whenever more is requested. This solves the same problem, and so we’re good to go!</p>
<h2 id="the-p-machine">The P’’ Machine</h2>
<p>Now, we know that a <em>P’’</em> machine is defined as two tapes: one for instructions, and one for memory. We know that the memory tape is <code>Tape Nat</code>, but what type should we use for our instructions?</p>
<p>We made a list of seven possible instructions before. An particular instruction could be any one of <em>Move Left</em>, <em>Move Right</em>, <em>Increment</em>, <em>Decrement</em>, <em>Enter Loop</em>, <em>Exit Loop</em>, or <em>Halt</em>. The word “or” in this list should indicate that we want a <em>sum</em> type to describe these options:</p>
<pre><code>type Instr = MoveLeft
           | MoveRight
           | Increment
           | Decrement
           | EnterLoop
           | ExitLoop
           | Halt</code></pre>
<p>and we can define the “points of interest” for our <code>Instr</code>uctions and <code>Nat</code>s:</p>
<pre><code>instance Point Instr where
  point = Halt

instance Point Nat where
  point = 0</code></pre>
<p>Given all of this, we can now define our <em>P’’</em> machine as the product type of a <code>Tape Instr</code> and a <code>Tape Nat</code>.</p>
<pre><code>type P'' = P'' (Tape Instr) (Tape Nat)</code></pre>
<p>You should be convinced that this <code>P''</code> type corresponds exactly to what we said we meant by a <em>P’’</em> machine. We still need to write functions to “execute” the program described by our <code>Tape Instr</code>, but that shouldn’t be too hard.</p>
<p>In the next chapter, we’ll build this “executor” function, which looks like <code>execute : P'' -&gt; P''</code> – transforming a <em>P’’</em> machine into another by evaluating the instruction at the <em>read head</em> of the program tape. When <code>execute</code> is run repetitively, until a <code>Halt</code> instruction is run, we’ll have our first working computer and everything will be groovy.</p>
<hr>
<h2 id="exercises">Exercises</h2>
<ol style="list-style-type: decimal">
<li>Use <em>equational reasoning</em> to show that <code>readHead (moveRight (moveLeft x)) = readHead x</code> for every <code>x : Point a =&gt; List a</code>, and that <code>readHead (moveLeft (moveRight x)) = readHead x</code>.</li>
<li>Why can’t we make the stronger claims of <em>equational reasoning</em> that <code>moveRight (moveLeft x) = x</code> and <code>moveLeft (moveRight x) = x</code>? Under which circumstances would this prove to not be true?</li>
<li>Prove that <code>Maybe a</code> has an <code>instance</code> of the <code>Point</code> pattern, by writing <em>the</em> instance for it.</li>
</ol>
</div>
<p class="meta">
    
    <span class="prev">
        <a href="https://reasonablypolymorphic.com/book/our-first-computer">←</a>
    </span>
    
    
    <span class="next">
        <a href="https://reasonablypolymorphic.com/book/operations">→</a>
    </span>
    
</p>
</article>

    <nav>
    <h1><a href="https://reasonablypolymorphic.com/">REASONABLY<br>POLYMORPHIC</a></h1>

    <p> Hi there. I'm <strong>Sandy Maguire</strong>. I like improving life and
    making cool things.</p>

    <p>If you want to get in touch, I'd love to hear from you! Send me an email;
    my name is <tt>sandy</tt> and this is my website.</p>

    <h2>THINGS I MAKE</h2>
    <ul>
        <li>Code on <a href="http://github.com/isovector">github</a></li>
        <li>Essays <a href="https://reasonablypolymorphic.com/blog/archives/">archive</a></li>
        <li>Book <a href="https://reasonablypolymorphic.com/book/preface">archive</a></li>
    </ul>

    <h2>WHAT I'M DOING</h2>
    <ul>
        <li>Music at <a href="http://last.fm/user/Paamayim">last.fm</a></li>
        <li>Books at <a href="https://www.goodreads.com/review/list/14945161-sandy-maguire?shelf=currently-reading">goodreads</a></li>
        <li>Papers at <a href="https://www.mendeley.com/groups/7295141/read/papers/">mendeley</a></li>
    </ul>

    <p>
    © 2011-2016 Sandy Maguire
    </p>
</nav>

</div>
    


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div></body></html>